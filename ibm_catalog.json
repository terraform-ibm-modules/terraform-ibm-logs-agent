{
  "products": [
    {
      "label": "Cloud automation for Logs Agent",
      "name": "deploy-arch-ibm-logs-agent",
      "product_kind": "solution",
      "tags": [
        "ibm_created",
        "target_terraform",
        "terraform",
        "solution",
        "logging",
        "logging_monitoring",
        "converged_infra"
      ],
      "keywords": [
        "logs",
        "agent",
        "IaC",
        "infrastructure as code",
        "terraform",
        "solution"
      ],
      "provider_name": "IBM",
      "short_description": "Automates the installation of the IBM Logs Agent on a Red Hat OpenShift Cluster or Kubernetes Service",
      "long_description": "The Cloud Automation for the [Logs Agent](https://cloud.ibm.com/docs/cloud-logs?topic=cloud-logs-agent-about) on a Red Hat OpenShift cluster or Kubernetes Service simplifies the configuration process, enabling the agent to collect and forward infrastructure and application logs directly to an IBM Cloud Logs instance.\n\nℹ️ This Terraform-based automation is part of a broader suite of IBM-maintained Infrastructure as Code (IaC) assets, each following the naming pattern \"Cloud automation for *servicename*\" and focusing on single IBM Cloud service. These single-service deployable architectures can be used on their own to streamline and automate service deployments through an [IaC approach](https://cloud.ibm.com/docs/secure-enterprise?topic=secure-enterprise-understanding-projects), or assembled together into a broader [automated IaC stack](https://cloud.ibm.com/docs/secure-enterprise?topic=secure-enterprise-config-stack) to automate the deployment of an end-to-end solution architecture.",
      "offering_docs_url": "https://github.com/terraform-ibm-modules/terraform-ibm-logs-agent/blob/main/README.md",
      "offering_icon_url": "https://raw.githubusercontent.com/terraform-ibm-modules/terraform-ibm-logs-agent/refs/heads/main/images/logs-icon.svg",
      "features": [
        {
          "title": "Logs Agent",
          "description": "Deploys the IBM Logs Agent on a [Red Hat OpenShift Cluster](https://cloud.ibm.com/docs/openshift) or [Kubernetes Service](https://cloud.ibm.com/docs/containers?topic=containers-getting-started)."
        }
      ],
      "flavors": [
        {
          "label": "Fully configurable",
          "name": "fully-configurable",
          "index": 1,
          "install_type": "fullstack",
          "working_directory": "solutions/fully-configurable",
          "compliance": {
            "authority": "scc-v3",
            "profiles": [
              {
                "profile_name": "IBM Cloud Framework for Financial Services",
                "profile_version": "1.7.0"
              }
            ]
          },
          "iam_permissions": [
            {
              "service_name": "containers-kubernetes",
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "notes": "Required to create and edit OpenShift cluster and the related resources."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::role:Viewer"
              ],
              "service_name": "Resource group only",
              "notes": "Viewer access is required in the resource group you want to provision in."
            },
            {
              "service_name": "logs",
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "notes": "[Optional] Required to create an instance of Cloud Logs."
            },
            {
              "service_name": "logs-router",
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager"
              ],
              "notes": "[Optional] Required for configuring Cloud Logs routing."
            },
            {
              "service_name": "sysdig-monitor",
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "notes": "[Optional] Required to create an instance of Cloud Monitoring."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "sysdig-secure",
              "notes": "[Optional] Required for creating and managing SCC Workload Protection instance."
            },
            {
              "service_name": "iam-identity",
              "role_crns": [
                "crn:v1:bluemix:public:iam::::role:Administrator",
                "crn:v1:bluemix:public:iam-identity::::serviceRole:UserApiKeyCreator"
              ],
              "notes": "[Optional] Required to create the containers-kubernetes-key needed by the OpenShift cluster on IBM Cloud."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::role:Administrator"
              ],
              "service_name": "All Account Management services",
              "notes": "[Optional] Required to create new resource groups when enabling the Account Configuration integration."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::role:Administrator"
              ],
              "service_name": "All Identity and Access enabled services",
              "notes": "[Optional] Required to create new resource groups with account settings when enabling the Account Configuration integration."
            },
            {
              "service_name": "is.vpc",
              "role_crns": [
                "crn:v1:bluemix:public:iam::::role:Administrator"
              ],
              "notes": "[Optional] Required for creating Virtual Private Cloud(VPC)."
            },
            {
              "service_name": "cloud-object-storage",
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "notes": "[Optional] Required to create Cloud Object Storage (COS) Instance."
            },
            {
              "service_name": "hs-crypto",
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "notes": "[Optional] Required if KMS encryption is enabled and IBM Hyper Protect Crypto Services is used to encrypt the Kubernetes Secrets and Object Storage bucket."
            },
            {
              "service_name": "kms",
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "notes": "[Optional] Required if Key Protect is used for encryption for Kubernetes Secrets and Object Storage bucket."
            },
            {
              "service_name": "atracker",
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Writer",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "notes": "[Optional] Required to set up Activity Tracker event routing of auditing events."
            },
            {
              "service_name": "secrets-manager",
              "role_crns": [
                "crn:v1:bluemix:public:iam::::role:Administrator",
                "crn:v1:bluemix:public:iam::::serviceRole:Manager"
              ],
              "notes": "[Optional] Required when enabling the Secrets Manager integration for the cluster."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::role:Administrator",
                "crn:v1:bluemix:public:iam::::serviceRole:Manager"
              ],
              "service_name": "apprapp",
              "notes": "[Optional] Required for provisioning the App Configuration instance."
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "event-notifications",
              "notes": "[Optional] Required when enabling the Event Notifications integration for secrets manager."
            }
          ],
          "architecture": {
            "features": [
              {
                "title": " ",
                "description": "Configured to use IBM secure by default standards, but can be edited to fit your use case."
              }
            ],
            "diagrams": [
              {
                "diagram": {
                  "url": "https://raw.githubusercontent.com/terraform-ibm-modules/terraform-ibm-logs-agent/refs/heads/main/reference-architecture/deployable-architecture-logs-agent.svg",
                  "caption": "Logs Agent topology",
                  "type": "image/svg+xml"
                },
                "description": "<b>Logs Agent</b> can be deployed on a Red Hat OpenShift cluster or a Kubernetes service to collect, process, and forward application and system logs to a [IBM Cloud Logs instance](https://cloud.ibm.com/docs/cloud-logs). This setup is essential for achieving comprehensive observability, supporting both real-time monitoring and historical analysis of workloads running within the cluster."
              }
            ]
          },
          "configuration": [
            {
              "key": "ibmcloud_api_key",
              "required": true
            },
            {
              "key": "cluster_id",
              "custom_config": {
                "type": "cluster_var",
                "grouping": "deployment",
                "original_grouping": "deployment"
              },
              "required": true
            },
            {
              "key": "cluster_resource_group_id",
              "required": true,
              "custom_config": {
                "type": "resource_group",
                "grouping": "deployment",
                "original_grouping": "deployment",
                "config_constraints": {
                  "identifier": "rg_id"
                }
              }
            },
            {
              "key": "is_vpc_cluster",
              "required": true
            },
            {
              "key": "is_ocp_cluster",
              "required": true
            },
            {
              "key": "region",
              "type": "string",
              "custom_config": {
                "config_constraints": {
                  "generationType": "2"
                },
                "grouping": "deployment",
                "original_grouping": "deployment",
                "type": "vpc_region"
              },
              "description": "Region in which cloud logs instance or OpenShift cluster will be deployed. [Learn More](https://terraform-ibm-modules.github.io/documentation/#/region).",
              "virtual": true,
              "required": true,
              "default_value": "us-south"
            },
            {
              "key": "cloud_logs_ingress_endpoint",
              "required": true
            },
            {
              "key": "cloud_logs_ingress_port",
              "required": true
            },
            {
              "key": "logs_agent_trusted_profile_id",
              "required": true
            },
            {
              "key": "logs_agent_name"
            },
            {
              "key": "logs_agent_namespace"
            },
            {
              "key": "logs_agent_chart"
            },
            {
              "key": "logs_agent_chart_location"
            },
            {
              "key": "logs_agent_chart_version"
            },
            {
              "key": "logs_agent_image_version"
            },
            {
              "key": "logs_agent_init_image_version"
            },
            {
              "key": "logs_agent_resources"
            },
            {
              "key": "logs_agent_system_logs",
              "custom_config": {
                "grouping": "deployment",
                "original_grouping": "deployment",
                "config_constraints": {
                  "type": "string"
                }
              }
            },
            {
              "key": "logs_agent_additional_metadata",
              "custom_config": {
                "type": "code_editor",
                "grouping": "deployment",
                "original_grouping": "deployment"
              }
            },
            {
              "key": "logs_agent_exclude_log_source_paths",
              "custom_config": {
                "grouping": "deployment",
                "original_grouping": "deployment",
                "config_constraints": {
                  "type": "string"
                }
              }
            },
            {
              "key": "logs_agent_iam_mode",
              "options": [
                {
                  "displayname": "Trusted Profile",
                  "value": "TrustedProfile"
                },
                {
                  "displayname": "IAM API Key",
                  "value": "IAMAPIKey"
                }
              ]
            },
            {
              "key": "logs_agent_iam_api_key"
            },
            {
              "key": "logs_agent_iam_environment",
              "options": [
                {
                  "displayname": "Production",
                  "value": "Production"
                },
                {
                  "displayname": "Private Production",
                  "value": "PrivateProduction"
                },
                {
                  "displayname": "Staging",
                  "value": "Staging"
                },
                {
                  "displayname": "Private Staging",
                  "value": "PrivateStaging"
                }
              ]
            },
            {
              "key": "logs_agent_log_source_namespaces",
              "custom_config": {
                "grouping": "deployment",
                "original_grouping": "deployment",
                "config_constraints": {
                  "type": "string"
                }
              }
            },
            {
              "key": "enable_annotations"
            },
            {
              "key": "max_unavailable"
            },
            {
              "key": "log_filters",
              "custom_config": {
                "type": "code_editor",
                "grouping": "deployment",
                "original_grouping": "deployment"
              }
            },
            {
              "key": "logs_agent_selected_log_source_paths"
            },
            {
              "key": "logs_agent_tolerations",
              "custom_config": {
                "type": "code_editor",
                "grouping": "deployment",
                "original_grouping": "deployment"
              }
            },
            {
              "key": "cluster_config_endpoint_type",
              "options": [
                {
                  "displayname": "Default",
                  "value": "default"
                },
                {
                  "displayname": "Private",
                  "value": "private"
                },
                {
                  "displayname": "VPE",
                  "value": "vpe"
                },
                {
                  "displayname": "Link",
                  "value": "link"
                }
              ]
            },
            {
              "key": "wait_till",
              "options": [
                {
                  "displayname": "Master Node Ready",
                  "value": "MasterNodeReady"
                },
                {
                  "displayname": "One Worker Node Ready",
                  "value": "OneWorkerNodeReady"
                },
                {
                  "displayname": "Ingress Ready",
                  "value": "IngressReady"
                },
                {
                  "displayname": "Normal",
                  "value": "Normal"
                }
              ]
            },
            {
              "key": "wait_till_timeout"
            },
            {
              "key": "enable_multiline"
            },
            {
              "key": "secrets_manager_service_plan",
              "required": true,
              "virtual": true,
              "type": "string",
              "options": [
                {
                  "displayname": "Standard",
                  "value": "standard"
                },
                {
                  "displayname": "Trial",
                  "value": "trial"
                }
              ],
              "default_value": "__NOT_SET__",
              "description": "The pricing plan to use when provisioning a Secrets Manager instance for centrally managing ingress certificates for OpenShift cluster. Possible values: `standard`, `trial`. You can create only one Trial instance of Secrets Manager per account. Before you can create a new Trial instance, you must delete the existing Trial instance and its reclamation. [Learn more](https://cloud.ibm.com/docs/secrets-manager?topic=secrets-manager-create-instance&interface=ui#upgrade-instance-standard)."
            },
            {
              "key": "enable_platform_metrics",
              "type": "boolean",
              "default_value": false,
              "description": "When set to `true`, the IBM Cloud Monitoring instance will be configured to collect platform metrics from the provided region. ⚠️ You can configure 1 instance only of the IBM Cloud Monitoring service per region to collect platform metrics in that location. Check with the account or service administrator if another monitoring instance has already been configured. You may not have permissions to see all monitoring instances in the region. [Learn more](https://cloud.ibm.com/docs/monitoring?topic=monitoring-platform_metrics_enabling).",
              "required": true,
              "virtual": true,
              "options": [
                {
                  "displayname": "true",
                  "value": "true"
                },
                {
                  "displayname": "false",
                  "value": "false"
                }
              ]
            },
            {
              "key": "logs_routing_tenant_regions",
              "type": "array",
              "default_value": [],
              "description": "To manage platform logs that are generated by IBM Cloud services in a region of IBM Cloud, you must create a tenant in each region that you operate. Pass a list of regions to create a tenant in. For example: [\"us-south\", \"us-east\"]. [Learn more](https://cloud.ibm.com/docs/logs-router?topic=logs-router-about-platform-logs).",
              "required": true,
              "virtual": true,
              "custom_config": {
                "grouping": "deployment",
                "original_grouping": "deployment",
                "config_constraints": {
                  "type": "string"
                }
              }
            },
            {
              "key": "provider_visibility",
              "options": [
                {
                  "displayname": "private",
                  "value": "private"
                },
                {
                  "displayname": "public",
                  "value": "public"
                },
                {
                  "displayname": "public-and-private",
                  "value": "public-and-private"
                }
              ],
              "hidden": true
            }
          ],
          "dependencies": [
            {
              "name": "deploy-arch-ibm-cloud-logs",
              "description": "Create IBM Cloud Logs Instance for storing and analysing platform and application logs .",
              "id": "63d8ae58-fbf3-41ce-b844-0fb5b85882ab-global",
              "version": "v1.6.11",
              "flavors": [
                "fully-configurable"
              ],
              "catalog_id": "7a4d68b4-cf8b-40cd-a3d1-f49aff526eb3",
              "optional": true,
              "on_by_default": true,
              "input_mapping": [
                {
                  "dependency_input": "region",
                  "version_input": "region",
                  "reference_version": true
                },
                {
                  "dependency_output": "cloud_logs_ingress_endpoint",
                  "version_input": "cloud_logs_ingress_endpoint"
                },
                {
                  "dependency_input": "enable_platform_metrics",
                  "version_input": "enable_platform_metrics",
                  "reference_version": true
                },
                {
                  "dependency_input": "logs_routing_tenant_regions",
                  "version_input": "logs_routing_tenant_regions",
                  "reference_version": true
                }
              ]
            },
            {
              "name": "deploy-arch-ibm-slz-ocp",
              "description": "Configure the Red Hat OpenShift cluster on which logs agent will be installed.",
              "catalog_id": "1082e7d2-5e2f-0a11-a3bc-f88a8e1931fc",
              "flavors": [
                "fully-configurable"
              ],
              "id": "95fccffc-ae3b-42df-b6d9-80be5914d852-global",
              "optional": true,
              "on_by_default": true,
              "input_mapping": [
                {
                  "dependency_output": "cluster_id",
                  "version_input": "cluster_id"
                },
                {
                  "dependency_output": "resource_group_id",
                  "version_input": "cluster_resource_group_id"
                },
                {
                  "version_input": "is_vpc_cluster",
                  "value": true
                },
                {
                  "dependency_input": "region",
                  "version_input": "region",
                  "reference_version": true
                },
                {
                  "dependency_input": "cluster_config_endpoint_type",
                  "version_input": "cluster_config_endpoint_type",
                  "reference_version": true
                },
                {
                  "dependency_input": "enable_platform_metrics",
                  "version_input": "enable_platform_metrics",
                  "reference_version": true
                },
                {
                  "dependency_input": "logs_routing_tenant_regions",
                  "version_input": "logs_routing_tenant_regions",
                  "reference_version": true
                },
                {
                  "dependency_input": "secrets_manager_service_plan",
                  "version_input": "secrets_manager_service_plan",
                  "reference_version": true
                }
              ],
              "version": "v3.58.2"
            }
          ],
          "dependency_version_2": true,
          "terraform_version": "1.10.5"
        }
      ]
    }
  ]
}
